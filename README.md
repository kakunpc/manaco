# Material Assign Non-destructive Assistant for Customization Operations（まなこ）

## 概要

ModularAvatar（NDMF）を利用して、非破壊で目のマテリアルを切り替えるEditor拡張です。

---

## インストール

### VCCを使ってインストール

1. [https://kakunpc.github.io/kakunpc_vpm/](https://kakunpc.github.io/kakunpc_vpm/) を開き、「Add to VCC」をクリックします。
2. VCCが起動し「Add Repository」ダイアログが表示されます。内容を確認したら「I Understand, Add Repository」をクリックします。
   - VCCが起動しない・インストール画面が表示されない場合は、VCCのインストールまたはバージョンアップを行ってください。
3. プロジェクトの「Manage Project」をクリックします。
4. 一覧から「MANACO」を見つけ、右側の ＋ ボタンをクリックします。

<img width="623" height="440" alt="248711958-2f3dae16-e7e3-4a40-b19f-daaa3530315d" src="https://github.com/user-attachments/assets/211021e2-7aca-48a7-a9ad-c688c9040af1" />

### UnityPackageでインストール

[Booth](../../releases/latest)から「Manaco.unitypackage」をダウンロードして、Unityのプロジェクトにインポートしてください。  
自動でVCC関係が解決されインストールされます。

---

## 使い方

### 一般利用者の方（プリセットが存在する場合）

1. アバターを右クリックし「ちゃとらとりー / Manaco（まなこ）」を選択します。
2. アバターに適したアバタープリセットを選択します。
3. 適用したいマテリアルプリセットを選択します。
4. 「Apply」をクリックします。
5. 必要に応じてNDMF Previewでマテリアルを確認します。
6. アップロードします。

### 一般利用者の方（プリセットが存在しない場合）

1. アバターを右クリックし「ちゃとらとりー / Manaco（まなこ）」を選択してセットアップウィンドウを開きます。
2. 「その他のアバター」のプリセットを選び、使用するマテリアルプリセットを選択して「Apply」をクリックします。
3. 生成された Manaco ゲームオブジェクトを選択し、Inspectorの「詳細設定」を開きます。
4. 「UV エディタを開く」ボタンをクリックし、左目・右目それぞれのUV Islandを設定します。
   - 左クリックでUV Islandを追加、右クリックで削除できます。
   - 1つ目に左目、2つ目に右目を設定してください。
5. 以降は「プリセットが存在する場合」の手順4以降と同じです。

### アバター制作者の方

目のUV設定をasset形式で保存・配布することができます。  
assetファイルであるため、本スクリプトを導入していないユーザーがアバターをアップロードしてもエラーが発生しません。

**作成方法**

1. アバターを右クリックし「ちゃとらとりー / Manaco（まなこ）」を選択してセットアップウィンドウを開きます。
2. 「その他のアバター」のプリセットを選んで「Apply」をクリックします。
3. 生成された Manaco ゲームオブジェクトを選択します。
4. GameObjectの名前をわかりやすい表記（例：`英語名 日本語名`）に変更します。書き出し時にこの名前がassetファイルに書き込まれます。（保存後に編集可能です）
5. Inspectorの「詳細設定」を開き、「UV エディタを開く」ボタンをクリックします。左目・右目それぞれのUV Islandを設定します。
6. Inspectorの「・・・」メニューから「Create Avatar Preset」を選択し、assetを保存します。
7. 保存したassetをアバターと一緒に配布します（Assetsフォルダ内であればどこに配置しても機能します）。

**assetファイルに含まれる情報について**

assetファイルにはテクスチャー上でのUVの位置のみが保存されています。  
3DモデルのMesh情報や全体のポリゴン構造は保存されていないため、当ツールで作成したassetの情報だけでは3Dモデルを再現することはできません。    
Blenderなどで書き出せるUVMap画像データで目の部分だけが保存されているようなイメージとなります。  

### Eyeマテリアル・シェーダー作者の方

マテリアル割当をasset形式で保存・配布することができます。  
assetファイルであるため、本スクリプトを導入していないユーザーがアバターをアップロードしてもエラーが発生しません。

**作成方法**

1. Projectウィンドウで右クリックし「Create / ちゃとらとりー / Manaco Material Definition」を選択します。
2. 作成したファイルをInspectorで設定します。
   - **Name**：ユーザーに表示される名前を入力します。
   - **Left Eye Material**：左目に適用するマテリアルを設定します。
   - **Right Eye Material**：右目に適用するマテリアルを設定します。
   - **Both Eye Material**：現バージョンでは未使用ですが、将来のアップデートで利用予定です。
3. 作成したassetを関連マテリアルと一緒に配布します（Assetsフォルダ内であればどこに配置しても機能します）。

---

## ライセンス

このEditor拡張は [CC BY-NC 4.0](https://creativecommons.org/licenses/by-nc/4.0/deed.ja) ライセンスで提供しています。

本スクリプトを使用して生成したアセットの利用については特に制限を設けていません。  
ご利用のアバター・テクスチャ・シェーダーそれぞれの利用規約に従ってください。
